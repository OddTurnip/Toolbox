<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Character Count - Utilities</title>
    <link rel="icon" type="image/x-icon" href="https://oddturnip.com/favicon_turnip.ico">
    <link rel="stylesheet" href="styles.css">
    <style>
        /* Page-specific styles */
        .container {
            max-width: 1200px;
        }
        .layout {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            align-items: stretch;
        }
        .input-section {
            display: flex;
            flex-direction: column;
        }
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            flex: 1;
        }
        .text-box {
            margin-bottom: 20px;
        }
        .text-box textarea {
            height: 150px;
            font-family: 'Consolas', 'Monaco', monospace;
        }
        .frequency-section {
            display: flex;
            flex-direction: column;
        }
        .frequency-section h3 {
            color: #333;
            margin-bottom: 15px;
            font-size: 1.1em;
        }
        .frequency-table {
            flex: 1;
            overflow-y: auto;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
        }
        .frequency-table table {
            width: 100%;
            border-collapse: collapse;
        }
        .frequency-table th {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 12px 10px;
            text-align: left;
            font-size: 0.85em;
            position: sticky;
            top: 0;
        }
        .frequency-table td {
            padding: 10px;
            border-bottom: 1px solid #eee;
            font-size: 0.9em;
        }
        .frequency-table tr:hover {
            background: #f8f9ff;
        }
        .frequency-table .char-display {
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 1.1em;
            background: #f0f0f0;
            padding: 3px 8px;
            border-radius: 4px;
            display: inline-block;
            min-width: 30px;
            text-align: center;
        }
        .frequency-table .char-display.invisible {
            background: #ffe0e0;
            color: #c00;
            font-size: 0.75em;
        }
        .frequency-table .char-display.emoji {
            background: #e0f0ff;
        }
        .frequency-table .bar {
            background: #e0e0e0;
            border-radius: 3px;
            height: 8px;
            overflow: hidden;
        }
        .frequency-table .bar-fill {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            height: 100%;
            border-radius: 3px;
        }
        @media (max-width: 900px) {
            .layout {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>
                <img src="https://oddturnip.com/img/odd_turnip_480.png" alt="OddTurnip Logo" class="header-logo">
                Character Count
            </h1>
            <p>Analyze character frequency and detect invisible characters</p>
        </header>

        <div class="content">
            <div class="warning-box" id="warningBox">
                <h4>Invisible Characters Detected!</h4>
                <p id="warningText">Your text contains invisible or zero-width characters. Check the frequency table for details.</p>
            </div>

            <div class="layout">
                <div class="input-section">
                    <div class="text-box">
                        <h3>Enter Your Text</h3>
                        <textarea id="inputText" placeholder="Paste or type text to analyze character frequency..."></textarea>
                        <div class="actions">
                            <button class="btn btn-secondary" id="clearBtn">Clear</button>
                        </div>
                    </div>

                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="number" id="totalChars">0</div>
                            <div class="label">Total Characters</div>
                        </div>
                        <div class="stat-card">
                            <div class="number" id="uniqueChars">0</div>
                            <div class="label">Unique Characters</div>
                        </div>
                        <div class="stat-card">
                            <div class="number" id="letterCount">0</div>
                            <div class="label">Letters</div>
                        </div>
                        <div class="stat-card">
                            <div class="number" id="digitCount">0</div>
                            <div class="label">Digits</div>
                        </div>
                        <div class="stat-card">
                            <div class="number" id="spaceCount">0</div>
                            <div class="label">Spaces</div>
                        </div>
                        <div class="stat-card">
                            <div class="number" id="symbolCount">0</div>
                            <div class="label">Symbols</div>
                        </div>
                        <div class="stat-card">
                            <div class="number" id="emojiCount">0</div>
                            <div class="label">Emoji</div>
                        </div>
                        <div class="stat-card">
                            <div class="number" id="invisibleCount">0</div>
                            <div class="label">Invisible</div>
                        </div>
                    </div>
                </div>

                <div class="frequency-section">
                    <h3>Character Frequency</h3>
                    <div class="frequency-table">
                        <table>
                            <thead>
                                <tr>
                                    <th>Character</th>
                                    <th>Count</th>
                                    <th>%</th>
                                    <th>Distribution</th>
                                </tr>
                            </thead>
                            <tbody id="frequencyBody">
                                <tr>
                                    <td colspan="4" style="text-align: center; color: #888; padding: 40px;">Enter text to see frequency distribution</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <div class="info-box">
                <h4>About This Tool</h4>
                <p>This tool analyzes all characters in your text, including emoji, symbols, and invisible characters. Invisible characters (zero-width spaces, non-breaking spaces, etc.) are highlighted in red - useful for detecting hidden characters that may cause issues in code or documents. The frequency table shows the distribution of each unique character.</p>
            </div>
        </div>

        <div class="footer">
            <div class="footer-links">
                <a href="index.html">&larr; Back to Utilities</a>
                <a href="https://www.oddturnip.com" target="_blank" class="oddturnip-link">
                    <img src="https://oddturnip.com/img/odd_turnip_48.png" alt="OddTurnip Logo">
                    <span>Created by OddTurnip.com</span>
                </a>
            </div>
        </div>
    </div>

    <script>
        const inputText = document.getElementById('inputText');
        const frequencyBody = document.getElementById('frequencyBody');
        const warningBox = document.getElementById('warningBox');
        const clearBtn = document.getElementById('clearBtn');

        // Stats elements
        const totalChars = document.getElementById('totalChars');
        const uniqueChars = document.getElementById('uniqueChars');
        const letterCount = document.getElementById('letterCount');
        const digitCount = document.getElementById('digitCount');
        const spaceCount = document.getElementById('spaceCount');
        const symbolCount = document.getElementById('symbolCount');
        const emojiCount = document.getElementById('emojiCount');
        const invisibleCount = document.getElementById('invisibleCount');

        // Invisible characters and their names
        const invisibleChars = {
            '\u0000': 'NULL',
            '\u0009': 'TAB',
            '\u000A': 'LINE FEED',
            '\u000B': 'VERT TAB',
            '\u000C': 'FORM FEED',
            '\u000D': 'CARRIAGE RETURN',
            '\u001B': 'ESCAPE',
            '\u0020': 'SPACE',
            '\u00A0': 'NO-BREAK SPACE',
            '\u1680': 'OGHAM SPACE',
            '\u2000': 'EN QUAD',
            '\u2001': 'EM QUAD',
            '\u2002': 'EN SPACE',
            '\u2003': 'EM SPACE',
            '\u2004': '3-PER-EM SPACE',
            '\u2005': '4-PER-EM SPACE',
            '\u2006': '6-PER-EM SPACE',
            '\u2007': 'FIGURE SPACE',
            '\u2008': 'PUNCT SPACE',
            '\u2009': 'THIN SPACE',
            '\u200A': 'HAIR SPACE',
            '\u200B': 'ZERO WIDTH SPACE',
            '\u200C': 'ZERO WIDTH NON-JOINER',
            '\u200D': 'ZERO WIDTH JOINER',
            '\u200E': 'LEFT-TO-RIGHT MARK',
            '\u200F': 'RIGHT-TO-LEFT MARK',
            '\u2028': 'LINE SEPARATOR',
            '\u2029': 'PARA SEPARATOR',
            '\u202A': 'LEFT-TO-RIGHT EMBED',
            '\u202B': 'RIGHT-TO-LEFT EMBED',
            '\u202C': 'POP DIRECTIONAL',
            '\u202D': 'LEFT-TO-RIGHT OVERRIDE',
            '\u202E': 'RIGHT-TO-LEFT OVERRIDE',
            '\u202F': 'NARROW NO-BREAK SPACE',
            '\u205F': 'MEDIUM MATH SPACE',
            '\u2060': 'WORD JOINER',
            '\u2061': 'FUNCTION APPLICATION',
            '\u2062': 'INVISIBLE TIMES',
            '\u2063': 'INVISIBLE SEPARATOR',
            '\u2064': 'INVISIBLE PLUS',
            '\u3000': 'IDEOGRAPHIC SPACE',
            '\uFEFF': 'BYTE ORDER MARK',
            '\uFFF9': 'INTERLINEAR ANNOTATION',
            '\uFFFA': 'INTERLINEAR ANNOTATION',
            '\uFFFB': 'INTERLINEAR ANNOTATION'
        };

        // Check if character is emoji (simplified check)
        function isEmoji(char) {
            const code = char.codePointAt(0);
            return (
                (code >= 0x1F300 && code <= 0x1F9FF) || // Misc Symbols, Emoticons, etc.
                (code >= 0x2600 && code <= 0x26FF) ||   // Misc Symbols
                (code >= 0x2700 && code <= 0x27BF) ||   // Dingbats
                (code >= 0x1F600 && code <= 0x1F64F) || // Emoticons
                (code >= 0x1F680 && code <= 0x1F6FF) || // Transport
                (code >= 0x1F1E0 && code <= 0x1F1FF) || // Flags
                (code >= 0x231A && code <= 0x231B) ||   // Watch, Hourglass
                (code >= 0x23E9 && code <= 0x23F3) ||   // Various
                (code >= 0x23F8 && code <= 0x23FA) ||   // Various
                (code >= 0x25AA && code <= 0x25AB) ||   // Squares
                (code >= 0x25B6 && code <= 0x25C0) ||   // Triangles
                (code >= 0x25FB && code <= 0x25FE) ||   // Squares
                (code >= 0x2614 && code <= 0x2615) ||   // Umbrella, Coffee
                (code >= 0x2648 && code <= 0x2653) ||   // Zodiac
                (code >= 0x267F && code <= 0x267F) ||   // Wheelchair
                (code >= 0x2693 && code <= 0x2693) ||   // Anchor
                (code >= 0x26A1 && code <= 0x26A1) ||   // High voltage
                (code >= 0x26AA && code <= 0x26AB) ||   // Circles
                (code >= 0x26BD && code <= 0x26BE) ||   // Sports
                (code >= 0x26C4 && code <= 0x26C5) ||   // Snowman, Sun
                (code >= 0x26CE && code <= 0x26CE) ||   // Ophiuchus
                (code >= 0x26D4 && code <= 0x26D4) ||   // No entry
                (code >= 0x26EA && code <= 0x26EA) ||   // Church
                (code >= 0x26F2 && code <= 0x26F3) ||   // Fountain, Golf
                (code >= 0x26F5 && code <= 0x26F5) ||   // Sailboat
                (code >= 0x26FA && code <= 0x26FA) ||   // Tent
                (code >= 0x26FD && code <= 0x26FD) ||   // Fuel pump
                code === 0x2702 ||                       // Scissors
                code === 0x2705 ||                       // Check mark
                code === 0x2708 ||                       // Airplane
                code === 0x2709 ||                       // Envelope
                code === 0x270A ||                       // Fist
                code === 0x270B ||                       // Hand
                code === 0x270C ||                       // Victory
                code === 0x270F ||                       // Pencil
                code === 0x2712 ||                       // Black nib
                code === 0x2714 ||                       // Check mark
                code === 0x2716 ||                       // X mark
                code === 0x271D ||                       // Cross
                code === 0x2721 ||                       // Star of David
                code === 0x2728 ||                       // Sparkles
                code === 0x2733 ||                       // Eight spoked
                code === 0x2734 ||                       // Eight pointed
                code === 0x2744 ||                       // Snowflake
                code === 0x2747 ||                       // Sparkle
                code === 0x274C ||                       // Cross mark
                code === 0x274E ||                       // Cross mark
                code === 0x2753 ||                       // Question mark
                code === 0x2754 ||                       // Question mark
                code === 0x2755 ||                       // Exclamation
                code === 0x2757 ||                       // Exclamation
                code === 0x2763 ||                       // Heart exclamation
                code === 0x2764 ||                       // Red heart
                code === 0x2795 ||                       // Plus
                code === 0x2796 ||                       // Minus
                code === 0x2797 ||                       // Division
                code === 0x27A1 ||                       // Right arrow
                code === 0x27B0 ||                       // Curly loop
                code === 0x27BF ||                       // Double curly loop
                code === 0x2934 ||                       // Arrow
                code === 0x2935                          // Arrow
            );
        }

        function isInvisibleChar(char) {
            if (invisibleChars[char] && char !== ' ' && char !== '\n' && char !== '\t') {
                return true;
            }
            const code = char.codePointAt(0);
            // Control characters (except common whitespace)
            if (code < 32 && code !== 9 && code !== 10 && code !== 13) return true;
            // Other invisible ranges
            if (code >= 0x200B && code <= 0x200F) return true;
            if (code >= 0x2028 && code <= 0x202F) return true;
            if (code >= 0x2060 && code <= 0x2064) return true;
            if (code === 0xFEFF) return true;
            return false;
        }

        function getCharDisplay(char) {
            // Check for invisible characters first
            if (invisibleChars[char] && char !== ' ') {
                return { display: invisibleChars[char], class: 'invisible' };
            }
            if (isInvisibleChar(char)) {
                const code = char.codePointAt(0);
                return { display: `U+${code.toString(16).toUpperCase().padStart(4, '0')}`, class: 'invisible' };
            }
            if (char === ' ') {
                return { display: 'SPACE', class: '' };
            }
            if (char === '\n') {
                return { display: 'NEWLINE', class: '' };
            }
            if (char === '\t') {
                return { display: 'TAB', class: '' };
            }
            if (isEmoji(char)) {
                return { display: char, class: 'emoji' };
            }
            return { display: char, class: '' };
        }

        function analyze() {
            const text = inputText.value;
            const chars = [...text]; // Properly handle Unicode including emoji

            // Count frequencies
            const freq = {};
            let letters = 0, digits = 0, spaces = 0, symbols = 0, emojis = 0, invisibles = 0;

            chars.forEach(char => {
                freq[char] = (freq[char] || 0) + 1;

                if (/[a-zA-Z]/.test(char)) {
                    letters++;
                } else if (/[0-9]/.test(char)) {
                    digits++;
                } else if (char === ' ' || char === '\n' || char === '\t') {
                    spaces++;
                } else if (isEmoji(char)) {
                    emojis++;
                } else if (isInvisibleChar(char)) {
                    invisibles++;
                } else {
                    symbols++;
                }
            });

            // Update stats
            totalChars.textContent = chars.length;
            uniqueChars.textContent = Object.keys(freq).length;
            letterCount.textContent = letters;
            digitCount.textContent = digits;
            spaceCount.textContent = spaces;
            symbolCount.textContent = symbols;
            emojiCount.textContent = emojis;
            invisibleCount.textContent = invisibles;

            // Show warning if invisible characters found
            warningBox.classList.toggle('visible', invisibles > 0);

            // Build frequency table
            if (chars.length === 0) {
                frequencyBody.innerHTML = '<tr><td colspan="4" style="text-align: center; color: #888; padding: 40px;">Enter text to see frequency distribution</td></tr>';
                return;
            }

            // Sort by frequency (descending)
            const sorted = Object.entries(freq).sort((a, b) => b[1] - a[1]);
            const maxCount = sorted[0][1];

            frequencyBody.innerHTML = sorted.map(([char, count]) => {
                const { display, class: charClass } = getCharDisplay(char);
                const percent = ((count / chars.length) * 100).toFixed(1);
                const barWidth = (count / maxCount) * 100;

                return `<tr>
                    <td><span class="char-display ${charClass}">${escapeHtml(display)}</span></td>
                    <td>${count}</td>
                    <td>${percent}%</td>
                    <td><div class="bar"><div class="bar-fill" style="width: ${barWidth}%"></div></div></td>
                </tr>`;
            }).join('');
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        inputText.addEventListener('input', analyze);

        clearBtn.addEventListener('click', function() {
            inputText.value = '';
            analyze();
            inputText.focus();
        });
    </script>
</body>
</html>
